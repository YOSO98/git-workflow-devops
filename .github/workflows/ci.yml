name: CI Pipeline

on:
  push:
    branches: [develop, feature/*]
  pull_request:
    branches: [main]

jobs:
  validation:
    name: Validation du code
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: VÃ©rifier les fichiers sensibles
        run: |
          echo "ğŸ” Recherche de fichiers .env..."
          if find . -name "*.env" | grep -q "."; then
            echo "âŒ Fichier .env dÃ©tectÃ© !"
            exit 1
          fi
          echo "âœ… Aucun fichier sensible trouvÃ©"

      - name: VÃ©rifier les scripts Bash
        run: |
          echo "ğŸ” VÃ©rification des scripts Bash..."
          if find . -name "*.sh" | grep -q "."; then
            bash -n scripts/monitoring.sh
            echo "âœ… Scripts Bash valides"
          fi

      - name: Afficher la structure du projet
        run: |
          echo "ğŸ“ Structure du projet :"
          find . -not -path './.git/*' -type f
